%===============================================================================
%     File: qrsol_test.m
%  Created: 2025-06-13 16:24
%   Author: Bernie Roesler
%
%  Description: Test cs_qrsol
%
%===============================================================================

% Take the matrix from random_6 (seed 565656) of
% `python/csparse/tests/test_qr_solve.py`
A = [0.    , 0.    , 0.9014, 0.    , 0.     ;
     0.0657, 0.    , 0.    , 0.7161, 0.3285 ;
     0.3806, 0.    , 0.3474, 0.    , 0.     ;
     0.    , 0.479 , 0.    , 0.    , 0.4527 ;
     0.0082, 0.    , 0.    , 0.    , 0.     ];

b = [0.3237, 0.9503, 0.4697, 0.4583, 0.3974]';

[M, N] = size(A);
x = cs_qrsol(sparse(A), b);  % large numbers since U(end, end) is 1e-21

fprintf('norm: %.2e\n', norm(A * x - b));  % 3.61e+03

%===============================================================================
%===============================================================================
